<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Finans Akışım</title>
    <style>
        :root {
            --bg-gradient: linear-gradient(135deg, #121212 0%, #1f1f46 100%);
            --card-bg: rgba(15, 15, 35, 0.75);
            --accent: #4ade80;
            --accent-strong: #22c55e;
            --text-primary: #f9fafb;
            --text-secondary: #cbd5f5;
            --danger: #fb7185;
            --danger-strong: #f43f5e;
            --income: #34d399;
            --expense: #f87171;
            font-size: 16px;
        }

        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            min-height: 100vh;
            font-family: "Inter", "Segoe UI", system-ui, -apple-system, sans-serif;
            background: var(--bg-gradient);
            color: var(--text-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 24px;
        }

        h1, h2, h3 {
            margin: 0;
        }

        a {
            color: var(--accent);
        }

        .app {
            width: min(1080px, 100%);
        }

        .card {
            background: var(--card-bg);
            backdrop-filter: blur(16px);
            border: 1px solid rgba(148, 163, 235, 0.08);
            border-radius: 18px;
            padding: 28px;
            box-shadow: 0 24px 60px rgba(15, 23, 42, 0.45);
        }

        .hidden {
            display: none !important;
        }

        /* Login */
        .auth-container {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .login-card {
            width: min(420px, 100%);
            display: flex;
            flex-direction: column;
            gap: 24px;
            position: relative;
        }

        .login-card h1 {
            font-size: 1.75rem;
            line-height: 1.3;
        }

        .login-card p {
            margin: 0;
            color: var(--text-secondary);
            line-height: 1.6;
        }

        .login-card label {
            display: flex;
            flex-direction: column;
            gap: 8px;
            font-size: 0.95rem;
            color: var(--text-secondary);
        }

        .login-card input {
            width: 100%;
            padding: 12px 16px;
            border-radius: 12px;
            border: 1px solid rgba(148, 163, 235, 0.2);
            background: rgba(15, 15, 35, 0.55);
            color: var(--text-primary);
            font-size: 1rem;
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
        }

        .login-card input:focus {
            outline: none;
            border-color: rgba(74, 222, 128, 0.7);
            box-shadow: 0 0 0 4px rgba(34, 197, 94, 0.15);
        }

        .login-card button {
            padding: 14px 18px;
            background: linear-gradient(135deg, var(--accent) 0%, var(--accent-strong) 100%);
            color: #0f172a;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .login-card button:hover {
            transform: translateY(-1px);
            box-shadow: 0 18px 30px rgba(74, 222, 128, 0.35);
        }

        .error {
            color: var(--danger);
            font-weight: 600;
        }

        /* Dashboard */
        .dashboard {
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        header.dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .dashboard-header h1 {
            font-size: clamp(1.8rem, 2.6vw, 2.4rem);
        }

        .logout-btn {
            background: transparent;
            border: 1px solid rgba(148, 163, 235, 0.35);
            color: var(--text-secondary);
            border-radius: 999px;
            padding: 10px 20px;
            font-size: 0.95rem;
            cursor: pointer;
            transition: border-color 0.2s ease, color 0.2s ease;
        }

        .logout-btn:hover {
            color: #fff;
            border-color: rgba(74, 222, 128, 0.65);
        }

        .grid {
            display: grid;
            gap: 20px;
        }

        .grid-3 {
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        }

        .summary-card h2 {
            font-size: 0.9rem;
            letter-spacing: 0.06em;
            color: rgba(148, 163, 235, 0.75);
            text-transform: uppercase;
        }

        .summary-card strong {
            font-size: clamp(1.75rem, 2.1vw, 2.2rem);
        }

        .summary-card span {
            font-size: 0.9rem;
            color: rgba(148, 163, 235, 0.7);
        }

        .summary-card.income strong {
            color: var(--income);
        }

        .summary-card.expense strong {
            color: var(--expense);
        }

        .summary-card.balance strong {
            color: var(--accent);
        }

        .form-grid {
            display: grid;
            gap: 16px;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
        }

        .form-grid input,
        .form-grid select,
        .form-grid textarea {
            width: 100%;
            padding: 12px 14px;
            border-radius: 12px;
            border: 1px solid rgba(148, 163, 235, 0.2);
            background: rgba(15, 15, 35, 0.55);
            color: var(--text-primary);
            font-size: 0.95rem;
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
        }

        .form-grid textarea {
            min-height: 56px;
            resize: vertical;
        }

        .form-grid input:focus,
        .form-grid select:focus,
        .form-grid textarea:focus {
            outline: none;
            border-color: rgba(74, 222, 128, 0.7);
            box-shadow: 0 0 0 4px rgba(34, 197, 94, 0.15);
        }

        .form-actions {
            display: flex;
            justify-content: flex-end;
        }

        .primary-btn {
            background: linear-gradient(135deg, var(--accent) 0%, var(--accent-strong) 100%);
            color: #0f172a;
            border: none;
            border-radius: 12px;
            padding: 12px 22px;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .primary-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 14px 24px rgba(74, 222, 128, 0.35);
        }

        .table-container {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 600px;
        }

        th, td {
            padding: 14px;
            text-align: left;
            border-bottom: 1px solid rgba(148, 163, 235, 0.12);
        }

        th {
            font-size: 0.85rem;
            letter-spacing: 0.05em;
            text-transform: uppercase;
            color: rgba(148, 163, 235, 0.7);
        }

        tr:last-child td {
            border-bottom: none;
        }

        .tag {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            border-radius: 999px;
            padding: 4px 10px;
            font-size: 0.82rem;
            font-weight: 600;
        }

        .tag.income {
            background: rgba(74, 222, 128, 0.1);
            color: var(--income);
        }

        .tag.expense {
            background: rgba(248, 113, 113, 0.1);
            color: var(--expense);
        }

        .tag small {
            font-size: 0.72rem;
            opacity: 0.7;
        }

        .delete-btn {
            background: none;
            border: 1px solid rgba(248, 113, 113, 0.45);
            color: var(--danger);
            border-radius: 999px;
            padding: 6px 12px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: border-color 0.2s ease, color 0.2s ease;
        }

        .delete-btn:hover {
            color: var(--danger-strong);
            border-color: rgba(244, 63, 94, 0.8);
        }

        .filters {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            align-items: center;
        }

        .filters select {
            padding: 8px 12px;
            border-radius: 999px;
            border: 1px solid rgba(148, 163, 235, 0.2);
            background: rgba(15, 15, 35, 0.55);
            color: var(--text-primary);
        }

        .recent-transactions {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .recent-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 14px 18px;
            border-radius: 14px;
            background: rgba(15, 23, 42, 0.45);
            border: 1px solid rgba(148, 163, 235, 0.08);
        }

        .recent-item span:first-child {
            font-weight: 600;
        }

        .recent-item small {
            color: rgba(148, 163, 235, 0.65);
        }

        @media (max-width: 960px) {
            body {
                padding: 16px;
            }

            .card {
                padding: 22px;
            }
        }

        @media (max-width: 720px) {
            header.dashboard-header {
                flex-direction: column;
                gap: 16px;
                align-items: flex-start;
            }

            .filters {
                flex-direction: column;
                align-items: flex-start;
            }

            .form-actions {
                justify-content: flex-start;
            }
        }

        @media (max-width: 520px) {
            body {
                padding: 12px;
            }

            .login-card {
                padding: 0 4px;
            }

            table {
                min-width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="app">
        <div id="login-screen" class="auth-container">
            <section class="card login-card">
                <div>
                    <h1>Kişisel Finans Takibi</h1>
                    <p>Güvenli alanınıza giriş yapın ve tüm gelir-gider akışınızı tek bir yerden yönetin.</p>
                </div>
                <form id="login-form">
                    <label>
                        Kullanıcı Adı
                        <input type="text" id="username" name="username" autocomplete="username" required>
                    </label>
                    <label>
                        Şifre
                        <input type="password" id="password" name="password" autocomplete="current-password" required>
                    </label>
                    <button type="submit">Giriş Yap</button>
                    <p id="login-error" class="error hidden">Kullanıcı adı veya şifre hatalı.</p>
                </form>
                <small style="color: rgba(148, 163, 235, 0.65);">Not: Bu uygulama yalnızca kişisel kullanım için tasarlanmıştır.</small>
            </section>
        </div>

        <main id="dashboard" class="dashboard hidden">
            <header class="dashboard-header">
                <div>
                    <h1>Finans Akışım</h1>
                    <p style="color: var(--text-secondary); margin-top: 6px;">Güncel hareketlerinizi ve dengenizi tek bakışta görün.</p>
                </div>
                <button id="logout-btn" class="logout-btn">Çıkış Yap</button>
            </header>

            <section class="grid grid-3">
                <article class="card summary-card balance">
                    <h2>Toplam Bakiye</h2>
                    <strong id="balance-total">₺0,00</strong>
                    <span id="balance-diff">Bu ay net değişim: ₺0,00</span>
                </article>
                <article class="card summary-card income">
                    <h2>Toplam Gelir</h2>
                    <strong id="income-total">₺0,00</strong>
                    <span id="income-month">Bu ay: ₺0,00</span>
                </article>
                <article class="card summary-card expense">
                    <h2>Toplam Gider</h2>
                    <strong id="expense-total">₺0,00</strong>
                    <span id="expense-month">Bu ay: ₺0,00</span>
                </article>
            </section>

            <section class="card">
                <header style="margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center; gap: 16px; flex-wrap: wrap;">
                    <div>
                        <h2 style="font-size: 1.3rem;">Yeni İşlem Ekle</h2>
                        <p style="color: var(--text-secondary); margin-top: 4px;">Gelir ve giderlerinizi anında kaydedin.</p>
                    </div>
                </header>
                <form id="transaction-form">
                    <div class="form-grid">
                        <label style="display:flex; flex-direction:column; gap:8px; color: var(--text-secondary);">
                            Tarih
                            <input type="date" id="transaction-date" required>
                        </label>
                        <label style="display:flex; flex-direction:column; gap:8px; color: var(--text-secondary);">
                            İşlem Tipi
                            <select id="transaction-type" required>
                                <option value="income">Gelir</option>
                                <option value="expense">Gider</option>
                            </select>
                        </label>
                        <label style="display:flex; flex-direction:column; gap:8px; color: var(--text-secondary);">
                            Kategori
                            <input type="text" id="transaction-category" placeholder="Örn. Maaş, Kira, Yemek" required>
                        </label>
                        <label style="display:flex; flex-direction:column; gap:8px; color: var(--text-secondary);">
                            Tutar (₺)
                            <input type="number" id="transaction-amount" min="0" step="0.01" required>
                        </label>
                        <label style="grid-column: 1 / -1; display:flex; flex-direction:column; gap:8px; color: var(--text-secondary);">
                            Açıklama
                            <textarea id="transaction-notes" placeholder="İsteğe bağlı not ekleyin"></textarea>
                        </label>
                    </div>
                    <div class="form-actions" style="margin-top: 20px;">
                        <button type="submit" class="primary-btn">İşlemi Kaydet</button>
                    </div>
                </form>
            </section>

            <section class="grid" style="grid-template-columns: minmax(0, 2fr) minmax(0, 1fr); gap: 24px;">
                <article class="card" style="display:flex; flex-direction:column; gap:20px;">
                    <header style="display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:12px;">
                        <div>
                            <h2 style="font-size:1.3rem;">İşlem Geçmişi</h2>
                            <p style="color:var(--text-secondary); margin-top:4px;">Tüm hareketlerinizi detaylı inceleyin.</p>
                        </div>
                        <div class="filters">
                            <select id="filter-type">
                                <option value="all">Tümü</option>
                                <option value="income">Gelir</option>
                                <option value="expense">Gider</option>
                            </select>
                        </div>
                    </header>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Tarih</th>
                                    <th>Kategori</th>
                                    <th>Açıklama</th>
                                    <th>Tip</th>
                                    <th>Tutar</th>
                                    <th></th>
                                </tr>
                            </thead>
                            <tbody id="transactions-table"></tbody>
                        </table>
                    </div>
                </article>

                <article class="card">
                    <h2 style="font-size:1.3rem; margin-bottom: 16px;">Son İşlemler</h2>
                    <div id="recent-transactions" class="recent-transactions"></div>
                </article>
            </section>
        </main>
    </div>

    <script>
        const credentials = {
            username: "atakanzgn",
            password: "Finans!2024"
        };

        const loginScreen = document.getElementById("login-screen");
        const dashboard = document.getElementById("dashboard");
        const loginForm = document.getElementById("login-form");
        const loginError = document.getElementById("login-error");
        const logoutBtn = document.getElementById("logout-btn");

        const transactionForm = document.getElementById("transaction-form");
        const transactionDate = document.getElementById("transaction-date");
        const transactionType = document.getElementById("transaction-type");
        const transactionCategory = document.getElementById("transaction-category");
        const transactionAmount = document.getElementById("transaction-amount");
        const transactionNotes = document.getElementById("transaction-notes");
        const transactionsTable = document.getElementById("transactions-table");
        const filterType = document.getElementById("filter-type");
        const recentTransactionsContainer = document.getElementById("recent-transactions");

        const balanceTotal = document.getElementById("balance-total");
        const balanceDiff = document.getElementById("balance-diff");
        const incomeTotal = document.getElementById("income-total");
        const incomeMonth = document.getElementById("income-month");
        const expenseTotal = document.getElementById("expense-total");
        const expenseMonth = document.getElementById("expense-month");

        function formatCurrency(value) {
            return new Intl.NumberFormat("tr-TR", {
                style: "currency",
                currency: "TRY",
                minimumFractionDigits: 2
            }).format(value);
        }

        function loadTransactions() {
            try {
                const stored = localStorage.getItem("finance-transactions");
                return stored ? JSON.parse(stored) : [];
            } catch (error) {
                console.error("Veriler okunurken hata oluştu", error);
                return [];
            }
        }

        function generateId() {
            if (window.crypto?.randomUUID) {
                return window.crypto.randomUUID();
            }
            return `tx-${Date.now()}-${Math.random().toString(16).slice(2)}`;
        }

        function saveTransactions(list) {
            localStorage.setItem("finance-transactions", JSON.stringify(list));
        }

        function updateSummary(transactions) {
            const totalIncome = transactions
                .filter(item => item.type === "income")
                .reduce((sum, item) => sum + item.amount, 0);
            const totalExpense = transactions
                .filter(item => item.type === "expense")
                .reduce((sum, item) => sum + item.amount, 0);
            const balance = totalIncome - totalExpense;

            const now = new Date();
            const currentMonth = now.getMonth();
            const currentYear = now.getFullYear();

            const monthIncome = transactions
                .filter(item => item.type === "income" && item.dateObj.getMonth() === currentMonth && item.dateObj.getFullYear() === currentYear)
                .reduce((sum, item) => sum + item.amount, 0);
            const monthExpense = transactions
                .filter(item => item.type === "expense" && item.dateObj.getMonth() === currentMonth && item.dateObj.getFullYear() === currentYear)
                .reduce((sum, item) => sum + item.amount, 0);
            const monthDiff = monthIncome - monthExpense;

            balanceTotal.textContent = formatCurrency(balance);
            balanceDiff.textContent = `Bu ay net değişim: ${formatCurrency(monthDiff)}`;
            incomeTotal.textContent = formatCurrency(totalIncome);
            expenseTotal.textContent = formatCurrency(totalExpense);
            incomeMonth.textContent = `Bu ay: ${formatCurrency(monthIncome)}`;
            expenseMonth.textContent = `Bu ay: ${formatCurrency(monthExpense)}`;
        }

        function renderTransactions(transactions, filter = "all") {
            const filtered = filter === "all" ? transactions : transactions.filter(item => item.type === filter);

            transactionsTable.innerHTML = filtered.length
                ? filtered
                    .map(item => `
                        <tr>
                            <td>${item.date}</td>
                            <td style="font-weight:600;">${item.category}</td>
                            <td>${item.notes ? `<small style="color: rgba(148, 163, 235, 0.75);">${item.notes}</small>` : "-"}</td>
                            <td>
                                <span class="tag ${item.type}">
                                    ${item.type === "income" ? "Gelir" : "Gider"}
                                </span>
                            </td>
                            <td style="font-weight:600; color:${item.type === "income" ? "var(--income)" : "var(--expense)"};">${formatCurrency(item.amount)}</td>
                            <td><button class="delete-btn" data-id="${item.id}">Sil</button></td>
                        </tr>
                    `)
                    .join("")
                : `<tr><td colspan="6" style="padding:24px; text-align:center; color: rgba(148, 163, 235, 0.6);">Filtreye uygun işlem bulunamadı.</td></tr>`;

            const recentMarkup = transactions
                .slice(0, 5)
                .map(item => `
                    <div class="recent-item">
                        <div style="display:flex; flex-direction:column; gap:4px;">
                            <span>${item.category}</span>
                            <small>${item.date} • ${item.type === "income" ? "Gelir" : "Gider"}</small>
                        </div>
                        <span style="font-weight:600; color:${item.type === "income" ? "var(--income)" : "var(--expense)"};">${formatCurrency(item.amount)}</span>
                    </div>
                `)
                .join("");

            recentTransactionsContainer.innerHTML = recentMarkup || '<p style="color: rgba(148, 163, 235, 0.65);">Henüz kayıtlı işlem bulunmuyor.</p>';
        }

        function attachDeleteHandlers(transactions) {
            transactionsTable.querySelectorAll(".delete-btn").forEach(button => {
                button.addEventListener("click", () => {
                    const id = button.getAttribute("data-id");
                    const updated = transactions.filter(item => item.id !== id);
                    const persistable = updated.map(({ dateObj, ...rest }) => rest);
                    saveTransactions(persistable);
                    refreshDashboard(updated);
                });
            });
        }

        function refreshDashboard(transactions) {
            updateSummary(transactions);
            renderTransactions(transactions, filterType.value);
            attachDeleteHandlers(transactions);
        }

        function hydrateTransactions(rawList) {
            return rawList
                .map(item => ({
                    ...item,
                    dateObj: new Date(item.date)
                }))
                .sort((a, b) => b.dateObj - a.dateObj);
        }

        function ensureDefaultDate() {
            const today = new Date().toISOString().split("T")[0];
            transactionDate.value = today;
        }

        loginForm.addEventListener("submit", event => {
            event.preventDefault();
            const usernameValue = document.getElementById("username").value.trim();
            const passwordValue = document.getElementById("password").value;

            if (usernameValue === credentials.username && passwordValue === credentials.password) {
                loginError.classList.add("hidden");
                sessionStorage.setItem("finance-logged-in", "true");
                showDashboard();
            } else {
                loginError.classList.remove("hidden");
            }
        });

        function showDashboard() {
            loginScreen.classList.add("hidden");
            dashboard.classList.remove("hidden");
            const transactions = hydrateTransactions(loadTransactions());
            refreshDashboard(transactions);
        }

        logoutBtn.addEventListener("click", () => {
            sessionStorage.removeItem("finance-logged-in");
            dashboard.classList.add("hidden");
            loginScreen.classList.remove("hidden");
            loginForm.reset();
            ensureDefaultDate();
        });

        transactionForm.addEventListener("submit", event => {
            event.preventDefault();
            const dateValue = transactionDate.value;
            const typeValue = transactionType.value;
            const categoryValue = transactionCategory.value.trim();
            const amountValue = parseFloat(transactionAmount.value);
            const notesValue = transactionNotes.value.trim();

            if (!dateValue || !categoryValue || !amountValue || amountValue <= 0) {
                return;
            }

            const transactions = hydrateTransactions(loadTransactions());
            const newTransaction = {
                id: generateId(),
                date: dateValue,
                dateObj: new Date(dateValue),
                type: typeValue,
                category: categoryValue,
                amount: amountValue,
                notes: notesValue
            };

            const updated = [newTransaction, ...transactions];
            saveTransactions(updated.map(({ dateObj, ...rest }) => rest));
            transactionForm.reset();
            ensureDefaultDate();
            refreshDashboard(updated);
        });

        filterType.addEventListener("change", () => {
            const transactions = hydrateTransactions(loadTransactions());
            renderTransactions(transactions, filterType.value);
            attachDeleteHandlers(transactions);
        });

        document.addEventListener("DOMContentLoaded", () => {
            ensureDefaultDate();
            if (sessionStorage.getItem("finance-logged-in") === "true") {
                showDashboard();
            }
        });
    </script>
</body>
</html>
